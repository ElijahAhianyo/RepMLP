# Data Cached Image Folder

[_Documentation generated by Documatic_](https://www.documatic.com)

<!---Documatic-section-Codebase Structure-start--->
## Codebase Structure

<!---Documatic-block-system_architecture-start--->
```mermaid
None
```
<!---Documatic-block-system_architecture-end--->

# #
<!---Documatic-section-Codebase Structure-end--->

<!---Documatic-section-data.cached_image_folder.has_file_allowed_extension-start--->
## data.cached_image_folder.has_file_allowed_extension

<!---Documatic-section-has_file_allowed_extension-start--->
<!---Documatic-block-data.cached_image_folder.has_file_allowed_extension-start--->
<details>
	<summary><code>data.cached_image_folder.has_file_allowed_extension</code> code snippet</summary>

```python
def has_file_allowed_extension(filename, extensions):
    filename_lower = filename.lower()
    return any((filename_lower.endswith(ext) for ext in extensions))
```
</details>
<!---Documatic-block-data.cached_image_folder.has_file_allowed_extension-end--->
<!---Documatic-section-has_file_allowed_extension-end--->

# #
<!---Documatic-section-data.cached_image_folder.has_file_allowed_extension-end--->

<!---Documatic-section-data.cached_image_folder.find_classes-start--->
## data.cached_image_folder.find_classes

<!---Documatic-section-find_classes-start--->
<!---Documatic-block-data.cached_image_folder.find_classes-start--->
<details>
	<summary><code>data.cached_image_folder.find_classes</code> code snippet</summary>

```python
def find_classes(dir):
    classes = [d for d in os.listdir(dir) if os.path.isdir(os.path.join(dir, d))]
    classes.sort()
    class_to_idx = {classes[i]: i for i in range(len(classes))}
    return (classes, class_to_idx)
```
</details>
<!---Documatic-block-data.cached_image_folder.find_classes-end--->
<!---Documatic-section-find_classes-end--->

# #
<!---Documatic-section-data.cached_image_folder.find_classes-end--->

<!---Documatic-section-data.cached_image_folder.make_dataset-start--->
## data.cached_image_folder.make_dataset

<!---Documatic-section-make_dataset-start--->
```mermaid
flowchart LR
data.cached_image_folder.make_dataset-->data.cached_image_folder.has_file_allowed_extension
```

### Object Calls

* data.cached_image_folder.has_file_allowed_extension

<!---Documatic-block-data.cached_image_folder.make_dataset-start--->
<details>
	<summary><code>data.cached_image_folder.make_dataset</code> code snippet</summary>

```python
def make_dataset(dir, class_to_idx, extensions):
    images = []
    dir = os.path.expanduser(dir)
    for target in sorted(os.listdir(dir)):
        d = os.path.join(dir, target)
        if not os.path.isdir(d):
            continue
        for (root, _, fnames) in sorted(os.walk(d)):
            for fname in sorted(fnames):
                if has_file_allowed_extension(fname, extensions):
                    path = os.path.join(root, fname)
                    item = (path, class_to_idx[target])
                    images.append(item)
    return images
```
</details>
<!---Documatic-block-data.cached_image_folder.make_dataset-end--->
<!---Documatic-section-make_dataset-end--->

# #
<!---Documatic-section-data.cached_image_folder.make_dataset-end--->

<!---Documatic-section-data.cached_image_folder.make_dataset_with_ann-start--->
## data.cached_image_folder.make_dataset_with_ann

<!---Documatic-section-make_dataset_with_ann-start--->
<!---Documatic-block-data.cached_image_folder.make_dataset_with_ann-start--->
<details>
	<summary><code>data.cached_image_folder.make_dataset_with_ann</code> code snippet</summary>

```python
def make_dataset_with_ann(ann_file, img_prefix, extensions):
    images = []
    with open(ann_file, 'r') as f:
        contents = f.readlines()
        for line_str in contents:
            path_contents = [c for c in line_str.split('\t')]
            im_file_name = path_contents[0]
            class_index = int(path_contents[1])
            assert str.lower(os.path.splitext(im_file_name)[-1]) in extensions
            item = (os.path.join(img_prefix, im_file_name), class_index)
            images.append(item)
    return images
```
</details>
<!---Documatic-block-data.cached_image_folder.make_dataset_with_ann-end--->
<!---Documatic-section-make_dataset_with_ann-end--->

# #
<!---Documatic-section-data.cached_image_folder.make_dataset_with_ann-end--->

<!---Documatic-section-data.cached_image_folder.pil_loader-start--->
## data.cached_image_folder.pil_loader

<!---Documatic-section-pil_loader-start--->
<!---Documatic-block-data.cached_image_folder.pil_loader-start--->
<details>
	<summary><code>data.cached_image_folder.pil_loader</code> code snippet</summary>

```python
def pil_loader(path):
    if isinstance(path, bytes):
        img = Image.open(io.BytesIO(path))
    elif is_zip_path(path):
        data = ZipReader.read(path)
        img = Image.open(io.BytesIO(data))
    else:
        with open(path, 'rb') as f:
            img = Image.open(f)
    return img.convert('RGB')
```
</details>
<!---Documatic-block-data.cached_image_folder.pil_loader-end--->
<!---Documatic-section-pil_loader-end--->

# #
<!---Documatic-section-data.cached_image_folder.pil_loader-end--->

<!---Documatic-section-data.cached_image_folder.accimage_loader-start--->
## data.cached_image_folder.accimage_loader

<!---Documatic-section-accimage_loader-start--->
```mermaid
flowchart LR
data.cached_image_folder.accimage_loader-->data.cached_image_folder.pil_loader
```

### Object Calls

* data.cached_image_folder.pil_loader

<!---Documatic-block-data.cached_image_folder.accimage_loader-start--->
<details>
	<summary><code>data.cached_image_folder.accimage_loader</code> code snippet</summary>

```python
def accimage_loader(path):
    import accimage
    try:
        return accimage.Image(path)
    except IOError:
        return pil_loader(path)
```
</details>
<!---Documatic-block-data.cached_image_folder.accimage_loader-end--->
<!---Documatic-section-accimage_loader-end--->

# #
<!---Documatic-section-data.cached_image_folder.accimage_loader-end--->

<!---Documatic-section-data.cached_image_folder.default_img_loader-start--->
## data.cached_image_folder.default_img_loader

<!---Documatic-section-default_img_loader-start--->
```mermaid
flowchart LR
data.cached_image_folder.default_img_loader-->data.cached_image_folder.accimage_loader
data.cached_image_folder.accimage_loader-->data.cached_image_folder.pil_loader
data.cached_image_folder.default_img_loader-->data.cached_image_folder.pil_loader
```

### Object Calls

* data.cached_image_folder.accimage_loader
* data.cached_image_folder.pil_loader

<!---Documatic-block-data.cached_image_folder.default_img_loader-start--->
<details>
	<summary><code>data.cached_image_folder.default_img_loader</code> code snippet</summary>

```python
def default_img_loader(path):
    from torchvision import get_image_backend
    if get_image_backend() == 'accimage':
        return accimage_loader(path)
    else:
        return pil_loader(path)
```
</details>
<!---Documatic-block-data.cached_image_folder.default_img_loader-end--->
<!---Documatic-section-default_img_loader-end--->

# #
<!---Documatic-section-data.cached_image_folder.default_img_loader-end--->

[_Documentation generated by Documatic_](https://www.documatic.com)